SCENARIO( "calculatePenetrability< Neutron >" ) {

  /* reference values generated using openMC */

  CHECK( 0.00 == Approx( calculatePenetrability< Neutron >( 0, 0.00, 0. ) ) );
  CHECK( 0.25 == Approx( calculatePenetrability< Neutron >( 0, 0.25, 0. ) ) );
  CHECK( 0.50 == Approx( calculatePenetrability< Neutron >( 0, 0.50, 0. ) ) );
  CHECK( 0.75 == Approx( calculatePenetrability< Neutron >( 0, 0.75, 0. ) ) );
  CHECK( 1.00 == Approx( calculatePenetrability< Neutron >( 0, 1.00, 0. ) ) );
  CHECK( 1.25 == Approx( calculatePenetrability< Neutron >( 0, 1.25, 0. ) ) );
  CHECK( 1.50 == Approx( calculatePenetrability< Neutron >( 0, 1.50, 0. ) ) );
  CHECK( 1.75 == Approx( calculatePenetrability< Neutron >( 0, 1.75, 0. ) ) );
  CHECK( 2.00 == Approx( calculatePenetrability< Neutron >( 0, 2.00, 0. ) ) );
  CHECK( 2.25 == Approx( calculatePenetrability< Neutron >( 0, 2.25, 0. ) ) );
  CHECK( 2.50 == Approx( calculatePenetrability< Neutron >( 0, 2.50, 0. ) ) );
  CHECK( 2.75 == Approx( calculatePenetrability< Neutron >( 0, 2.75, 0. ) ) );
  CHECK( 3.00 == Approx( calculatePenetrability< Neutron >( 0, 3.00, 0. ) ) );
  CHECK( 3.25 == Approx( calculatePenetrability< Neutron >( 0, 3.25, 0. ) ) );
  CHECK( 3.50 == Approx( calculatePenetrability< Neutron >( 0, 3.50, 0. ) ) );
  CHECK( 3.75 == Approx( calculatePenetrability< Neutron >( 0, 3.75, 0. ) ) );
  CHECK( 4.00 == Approx( calculatePenetrability< Neutron >( 0, 4.00, 0. ) ) );
  CHECK( 4.25 == Approx( calculatePenetrability< Neutron >( 0, 4.25, 0. ) ) );
  CHECK( 4.50 == Approx( calculatePenetrability< Neutron >( 0, 4.50, 0. ) ) );
  CHECK( 4.75 == Approx( calculatePenetrability< Neutron >( 0, 4.75, 0. ) ) );
  CHECK( 5.00 == Approx( calculatePenetrability< Neutron >( 0, 5.00, 0. ) ) );

  CHECK( 0.0                  == Approx( calculatePenetrability< Neutron >( 1, 0.00, 0. ) ) );
  CHECK( 0.014705882352941176 == Approx( calculatePenetrability< Neutron >( 1, 0.25, 0. ) ) );
  CHECK( 0.10000000000000001  == Approx( calculatePenetrability< Neutron >( 1, 0.50, 0. ) ) );
  CHECK( 0.27000000000000002  == Approx( calculatePenetrability< Neutron >( 1, 0.75, 0. ) ) );
  CHECK( 0.5                  == Approx( calculatePenetrability< Neutron >( 1, 1.00, 0. ) ) );
  CHECK( 0.76219512195121952  == Approx( calculatePenetrability< Neutron >( 1, 1.25, 0. ) ) );
  CHECK( 1.0384615384615385   == Approx( calculatePenetrability< Neutron >( 1, 1.50, 0. ) ) );
  CHECK( 1.3192307692307692   == Approx( calculatePenetrability< Neutron >( 1, 1.75, 0. ) ) );
  CHECK( 1.6000000000000001   == Approx( calculatePenetrability< Neutron >( 1, 2.00, 0. ) ) );
  CHECK( 1.8788659793814433   == Approx( calculatePenetrability< Neutron >( 1, 2.25, 0. ) ) );
  CHECK( 2.1551724137931036   == Approx( calculatePenetrability< Neutron >( 1, 2.50, 0. ) ) );
  CHECK( 2.4288321167883211   == Approx( calculatePenetrability< Neutron >( 1, 2.75, 0. ) ) );
  CHECK( 2.7000000000000002   == Approx( calculatePenetrability< Neutron >( 1, 3.00, 0. ) ) );
  CHECK( 2.9689189189189191   == Approx( calculatePenetrability< Neutron >( 1, 3.25, 0. ) ) );
  CHECK( 3.2358490566037736   == Approx( calculatePenetrability< Neutron >( 1, 3.50, 0. ) ) );
  CHECK( 3.5010373443983402   == Approx( calculatePenetrability< Neutron >( 1, 3.75, 0. ) ) );
  CHECK( 3.7647058823529411   == Approx( calculatePenetrability< Neutron >( 1, 4.00, 0. ) ) );
  CHECK( 4.027049180327869    == Approx( calculatePenetrability< Neutron >( 1, 4.25, 0. ) ) );
  CHECK( 4.2882352941176469   == Approx( calculatePenetrability< Neutron >( 1, 4.50, 0. ) ) );
  CHECK( 4.5484084880636608   == Approx( calculatePenetrability< Neutron >( 1, 4.75, 0. ) ) );
  CHECK( 4.8076923076923075   == Approx( calculatePenetrability< Neutron >( 1, 5.00, 0. ) ) );

  CHECK( 0.0                    == Approx( calculatePenetrability< Neutron >( 2, 0.00, 0. ) ) );
  CHECK( 0.00010624734381640459 == Approx( calculatePenetrability< Neutron >( 2, 0.25, 0. ) ) );
  CHECK( 0.0031847133757961785  == Approx( calculatePenetrability< Neutron >( 2, 0.50, 0. ) ) );
  CHECK( 0.021565495207667731   == Approx( calculatePenetrability< Neutron >( 2, 0.75, 0. ) ) );
  CHECK( 0.076923076923076927   == Approx( calculatePenetrability< Neutron >( 2, 1.00, 0. ) ) );
  CHECK( 0.18921046258173893    == Approx( calculatePenetrability< Neutron >( 2, 1.25, 0. ) ) );
  CHECK( 0.36486486486486486    == Approx( calculatePenetrability< Neutron >( 2, 1.50, 0. ) ) );
  CHECK( 0.5954017287799348     == Approx( calculatePenetrability< Neutron >( 2, 1.75, 0. ) ) );
  CHECK( 0.86486486486486491    == Approx( calculatePenetrability< Neutron >( 2, 2.00, 0. ) ) );
  CHECK( 1.1575511644318983     == Approx( calculatePenetrability< Neutron >( 2, 2.25, 0. ) ) );
  CHECK( 1.4616463985032742     == Approx( calculatePenetrability< Neutron >( 2, 2.50, 0. ) ) );
  CHECK( 1.7695578605019118     == Approx( calculatePenetrability< Neutron >( 2, 2.75, 0. ) ) );
  CHECK( 2.0769230769230771     == Approx( calculatePenetrability< Neutron >( 2, 3.00, 0. ) ) );
  CHECK( 2.3814878004977293     == Approx( calculatePenetrability< Neutron >( 2, 3.25, 0. ) ) );
  CHECK( 2.6822534312160866     == Approx( calculatePenetrability< Neutron >( 2, 3.50, 0. ) ) );
  CHECK( 2.9789224685778843     == Approx( calculatePenetrability< Neutron >( 2, 3.75, 0. ) ) );
  CHECK( 3.2715654952076676     == Approx( calculatePenetrability< Neutron >( 2, 4.00, 0. ) ) );
  CHECK( 3.5604306047323391     == Approx( calculatePenetrability< Neutron >( 2, 4.25, 0. ) ) );
  CHECK( 3.8458382180539274     == Approx( calculatePenetrability< Neutron >( 2, 4.50, 0. ) ) );
  CHECK( 4.128125145879042      == Approx( calculatePenetrability< Neutron >( 2, 4.75, 0. ) ) );
  CHECK( 4.4076163610719323     == Approx( calculatePenetrability< Neutron >( 2, 5.00, 0. ) ) );

  CHECK( 0.0                    == Approx( calculatePenetrability< Neutron >( 3, 0.00, 0. ) ) );
  CHECK( 2.6789053349863964e-07 == Approx( calculatePenetrability< Neutron >( 3, 0.25, 0. ) ) );
  CHECK( 3.3014196104324863e-05 == Approx( calculatePenetrability< Neutron >( 3, 0.50, 0. ) ) );
  CHECK( 0.00052888173072737556 == Approx( calculatePenetrability< Neutron >( 3, 0.75, 0. ) ) );
  CHECK( 0.0036101083032490976  == Approx( calculatePenetrability< Neutron >( 3, 1.00, 0. ) ) );
  CHECK( 0.015196755431928262   == Approx( calculatePenetrability< Neutron >( 3, 1.25, 0. ) ) );
  CHECK( 0.046427206725257929   == Approx( calculatePenetrability< Neutron >( 3, 1.50, 0. ) ) );
  CHECK( 0.11224672545625537    == Approx( calculatePenetrability< Neutron >( 3, 1.75, 0. ) ) );
  CHECK( 0.22654867256637168    == Approx( calculatePenetrability< Neutron >( 3, 2.00, 0. ) ) );
  CHECK( 0.39646402855156321    == Approx( calculatePenetrability< Neutron >( 3, 2.25, 0. ) ) );
  CHECK( 0.61979373264577553    == Approx( calculatePenetrability< Neutron >( 3, 2.50, 0. ) ) );
  CHECK( 0.8869711378018893     == Approx( calculatePenetrability< Neutron >( 3, 2.75, 0. ) ) );
  CHECK( 1.1853658536585365     == Approx( calculatePenetrability< Neutron >( 3, 3.00, 0. ) ) );
  CHECK( 1.503009611344865      == Approx( calculatePenetrability< Neutron >( 3, 3.25, 0. ) ) );
  CHECK( 1.8304779220548293     == Approx( calculatePenetrability< Neutron >( 3, 3.50, 0. ) ) );
  CHECK( 2.161220272993249      == Approx( calculatePenetrability< Neutron >( 3, 3.75, 0. ) ) );
  CHECK( 2.491105367188688      == Approx( calculatePenetrability< Neutron >( 3, 4.00, 0. ) ) );
  CHECK( 2.817759654775601      == Approx( calculatePenetrability< Neutron >( 3, 4.25, 0. ) ) );
  CHECK( 3.139976366322009      == Approx( calculatePenetrability< Neutron >( 3, 4.50, 0. ) ) );
  CHECK( 3.4572748731582088     == Approx( calculatePenetrability< Neutron >( 3, 4.75, 0. ) ) );
  CHECK( 3.7696019300361883     == Approx( calculatePenetrability< Neutron >( 3, 5.00, 0. ) ) );

  CHECK( 0.0                    == Approx( calculatePenetrability< Neutron >( 4, 0.00, 0. ) ) );
  CHECK( 3.4292596900052667e-10 == Approx( calculatePenetrability< Neutron >( 4, 0.25, 0. ) ) );
  CHECK( 1.7091673927779473e-07 == Approx( calculatePenetrability< Neutron >( 4, 0.50, 0. ) ) );
  CHECK( 6.2803298724456102e-06 == Approx( calculatePenetrability< Neutron >( 4, 0.75, 0. ) ) );
  CHECK( 7.8455986191746437e-05 == Approx( calculatePenetrability< Neutron >( 4, 1.00, 0. ) ) );
  CHECK( 0.00053757409302012836 == Approx( calculatePenetrability< Neutron >( 4, 1.25, 0. ) ) );
  CHECK( 0.002497664506668433   == Approx( calculatePenetrability< Neutron >( 4, 1.50, 0. ) ) );
  CHECK( 0.0088015269632856878  == Approx( calculatePenetrability< Neutron >( 4, 1.75, 0. ) ) );
  CHECK( 0.0251214366321574     == Approx( calculatePenetrability< Neutron >( 4, 2.00, 0. ) ) );
  CHECK( 0.060537968624390849   == Approx( calculatePenetrability< Neutron >( 4, 2.25, 0. ) ) );
  CHECK( 0.12669425695946757    == Approx( calculatePenetrability< Neutron >( 4, 2.50, 0. ) ) );
  CHECK( 0.23514284018438844    == Approx( calculatePenetrability< Neutron >( 4, 2.75, 0. ) ) );
  CHECK( 0.39377025567158802    == Approx( calculatePenetrability< Neutron >( 4, 3.00, 0. ) ) );
  CHECK( 0.60419326632260684    == Approx( calculatePenetrability< Neutron >( 4, 3.25, 0. ) ) );
  CHECK( 0.86157462719357891    == Approx( calculatePenetrability< Neutron >( 4, 3.50, 0. ) ) );
  CHECK( 1.1566720140320819     == Approx( calculatePenetrability< Neutron >( 4, 3.75, 0. ) ) );
  CHECK( 1.478692020013425      == Approx( calculatePenetrability< Neutron >( 4, 4.00, 0. ) ) );
  CHECK( 1.8175851921669044     == Approx( calculatePenetrability< Neutron >( 4, 4.25, 0. ) ) );
  CHECK( 2.1652476381912984     == Approx( calculatePenetrability< Neutron >( 4, 4.50, 0. ) ) );
  CHECK( 2.5157918867739499     == Approx( calculatePenetrability< Neutron >( 4, 4.75, 0. ) ) );
  CHECK( 2.8652901048925403     == Approx( calculatePenetrability< Neutron >( 4, 5.00, 0. ) ) );
}
