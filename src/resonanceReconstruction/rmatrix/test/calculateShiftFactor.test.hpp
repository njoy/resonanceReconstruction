SCENARIO( "calculateShiftFactor< Neutron >" ) {

  /* reference values generated using openMC */

  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 0.00, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 0.25, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 0.50, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 0.75, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 1.00, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 1.25, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 1.50, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 1.75, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 2.00, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 2.25, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 2.50, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 2.75, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 3.00, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 3.25, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 3.50, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 3.75, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 4.00, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 4.25, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 4.50, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 4.75, 0. ) ) );
  CHECK( 0. == Approx( calculateShiftFactor< Neutron >( 0, 5.00, 0. ) ) );

  CHECK( -1.0                  == Approx( calculateShiftFactor< Neutron >( 1, 0.00, 0. ) ) );
  CHECK( -0.94117647058823528  == Approx( calculateShiftFactor< Neutron >( 1, 0.25, 0. ) ) );
  CHECK( -0.80000000000000004  == Approx( calculateShiftFactor< Neutron >( 1, 0.50, 0. ) ) );
  CHECK( -0.64000000000000001  == Approx( calculateShiftFactor< Neutron >( 1, 0.75, 0. ) ) );
  CHECK( -0.5                  == Approx( calculateShiftFactor< Neutron >( 1, 1.00, 0. ) ) );
  CHECK( -0.3902439024390244   == Approx( calculateShiftFactor< Neutron >( 1, 1.25, 0. ) ) );
  CHECK( -0.30769230769230771  == Approx( calculateShiftFactor< Neutron >( 1, 1.50, 0. ) ) );
  CHECK( -0.24615384615384617  == Approx( calculateShiftFactor< Neutron >( 1, 1.75, 0. ) ) );
  CHECK( -0.20000000000000001  == Approx( calculateShiftFactor< Neutron >( 1, 2.00, 0. ) ) );
  CHECK( -0.16494845360824742  == Approx( calculateShiftFactor< Neutron >( 1, 2.25, 0. ) ) );
  CHECK( -0.13793103448275862  == Approx( calculateShiftFactor< Neutron >( 1, 2.50, 0. ) ) );
  CHECK( -0.11678832116788321  == Approx( calculateShiftFactor< Neutron >( 1, 2.75, 0. ) ) );
  CHECK( -0.10000000000000001  == Approx( calculateShiftFactor< Neutron >( 1, 3.00, 0. ) ) );
  CHECK( -0.086486486486486491 == Approx( calculateShiftFactor< Neutron >( 1, 3.25, 0. ) ) );
  CHECK( -0.075471698113207544 == Approx( calculateShiftFactor< Neutron >( 1, 3.50, 0. ) ) );
  CHECK( -0.066390041493775934 == Approx( calculateShiftFactor< Neutron >( 1, 3.75, 0. ) ) );
  CHECK( -0.058823529411764705 == Approx( calculateShiftFactor< Neutron >( 1, 4.00, 0. ) ) );
  CHECK( -0.052459016393442623 == Approx( calculateShiftFactor< Neutron >( 1, 4.25, 0. ) ) );
  CHECK( -0.047058823529411764 == Approx( calculateShiftFactor< Neutron >( 1, 4.50, 0. ) ) );
  CHECK( -0.042440318302387266 == Approx( calculateShiftFactor< Neutron >( 1, 4.75, 0. ) ) );
  CHECK( -0.038461538461538464 == Approx( calculateShiftFactor< Neutron >( 1, 5.00, 0. ) ) );

  CHECK( -2.0                 == Approx( calculateShiftFactor< Neutron >( 2, 0.00, 0. ) ) );
  CHECK( -1.9787505312367191  == Approx( calculateShiftFactor< Neutron >( 2, 0.25, 0. ) ) );
  CHECK( -1.910828025477707   == Approx( calculateShiftFactor< Neutron >( 2, 0.50, 0. ) ) );
  CHECK( -1.7891373801916932  == Approx( calculateShiftFactor< Neutron >( 2, 0.75, 0. ) ) );
  CHECK( -1.6153846153846154  == Approx( calculateShiftFactor< Neutron >( 2, 1.00, 0. ) ) );
  CHECK( -1.4066359893436668  == Approx( calculateShiftFactor< Neutron >( 2, 1.25, 0. ) ) );
  CHECK( -1.1891891891891893  == Approx( calculateShiftFactor< Neutron >( 2, 1.50, 0. ) ) );
  CHECK( -0.98625478248547538 == Approx( calculateShiftFactor< Neutron >( 2, 1.75, 0. ) ) );
  CHECK( -0.81081081081081086 == Approx( calculateShiftFactor< Neutron >( 2, 2.00, 0. ) ) );
  CHECK( -0.66619618913196899 == Approx( calculateShiftFactor< Neutron >( 2, 2.25, 0. ) ) );
  CHECK( -0.55004677268475211 == Approx( calculateShiftFactor< Neutron >( 2, 2.50, 0. ) ) );
  CHECK( -0.45778578648969365 == Approx( calculateShiftFactor< Neutron >( 2, 2.75, 0. ) ) );
  CHECK( -0.38461538461538464 == Approx( calculateShiftFactor< Neutron >( 2, 3.00, 0. ) ) );
  CHECK( -0.32634630679631577 == Approx( calculateShiftFactor< Neutron >( 2, 3.25, 0. ) ) );
  CHECK( -0.27960421321417173 == Approx( calculateShiftFactor< Neutron >( 2, 3.50, 0. ) ) );
  CHECK( -0.24177376076825308 == Approx( calculateShiftFactor< Neutron >( 2, 3.75, 0. ) ) );
  CHECK( -0.2108626198083067  == Approx( calculateShiftFactor< Neutron >( 2, 4.00, 0. ) ) );
  CHECK( -0.18536164578673381 == Approx( calculateShiftFactor< Neutron >( 2, 4.25, 0. ) ) );
  CHECK( -0.16412661195779601 == Approx( calculateShiftFactor< Neutron >( 2, 4.50, 0. ) ) );
  CHECK( -0.14628583622868499 == Approx( calculateShiftFactor< Neutron >( 2, 4.75, 0. ) ) );
  CHECK( -0.1311706629055007  == Approx( calculateShiftFactor< Neutron >( 2, 5.00, 0. ) ) );

  CHECK( -3.0                 == Approx( calculateShiftFactor< Neutron >( 3, 0.00, 0. ) ) );
  CHECK( -2.9874466496002539  == Approx( calculateShiftFactor< Neutron >( 3, 0.25, 0. ) ) );
  CHECK( -2.9490921096071312  == Approx( calculateShiftFactor< Neutron >( 3, 0.50, 0. ) ) );
  CHECK( -2.8825490793540243  == Approx( calculateShiftFactor< Neutron >( 3, 0.75, 0. ) ) );
  CHECK( -2.7833935018050542  == Approx( calculateShiftFactor< Neutron >( 3, 1.00, 0. ) ) );
  CHECK( -2.6460736446925637  == Approx( calculateShiftFactor< Neutron >( 3, 1.25, 0. ) ) );
  CHECK( -2.4669468857470385  == Approx( calculateShiftFactor< Neutron >( 3, 1.50, 0. ) ) );
  CHECK( -2.2485005928934565  == Approx( calculateShiftFactor< Neutron >( 3, 1.75, 0. ) ) );
  CHECK( -2.0017699115044247  == Approx( calculateShiftFactor< Neutron >( 3, 2.00, 0. ) ) );
  CHECK( -1.7443190804295865  == Approx( calculateShiftFactor< Neutron >( 3, 2.25, 0. ) ) );
  CHECK( -1.4946449821499406  == Approx( calculateShiftFactor< Neutron >( 3, 2.50, 0. ) ) );
  CHECK( -1.2668234468196127  == Approx( calculateShiftFactor< Neutron >( 3, 2.75, 0. ) ) );
  CHECK( -1.0682926829268293  == Approx( calculateShiftFactor< Neutron >( 3, 3.00, 0. ) ) );
  CHECK( -0.90066929222502901 == Approx( calculateShiftFactor< Neutron >( 3, 3.25, 0. ) ) );
  CHECK( -0.76186581196961145 == Approx( calculateShiftFactor< Neutron >( 3, 3.50, 0. ) ) );
  CHECK( -0.64808005373345023 == Approx( calculateShiftFactor< Neutron >( 3, 3.75, 0. ) ) );
  CHECK( -0.55511631442907106 == Approx( calculateShiftFactor< Neutron >( 3, 4.00, 0. ) ) );
  CHECK( -0.47907359311045444 == Approx( calculateShiftFactor< Neutron >( 3, 4.25, 0. ) ) );
  CHECK( -0.4166144756277696  == Approx( calculateShiftFactor< Neutron >( 3, 4.50, 0. ) ) );
  CHECK( -0.36500842852942922 == Approx( calculateShiftFactor< Neutron >( 3, 4.75, 0. ) ) );
  CHECK( -0.32207478890229191 == Approx( calculateShiftFactor< Neutron >( 3, 5.00, 0. ) ) );

  CHECK( -4.0                 == Approx( calculateShiftFactor< Neutron >( 4, 0.00, 0. ) ) );
  CHECK( -3.99105538787855    == Approx( calculateShiftFactor< Neutron >( 4, 0.25, 0. ) ) );
  CHECK( -3.9640240773828954  == Approx( calculateShiftFactor< Neutron >( 4, 0.50, 0. ) ) );
  CHECK( -3.9182715604069123  == Approx( calculateShiftFactor< Neutron >( 4, 0.75, 0. ) ) );
  CHECK( -3.8525812019457084  == Approx( calculateShiftFactor< Neutron >( 4, 1.00, 0. ) ) );
  CHECK( -3.7649000125260783  == Approx( calculateShiftFactor< Neutron >( 4, 1.25, 0. ) ) );
  CHECK( -3.6520948632851313  == Approx( calculateShiftFactor< Neutron >( 4, 1.50, 0. ) ) );
  CHECK( -3.5100405270183899  == Approx( calculateShiftFactor< Neutron >( 4, 1.75, 0. ) ) );
  CHECK( -3.3344781904715175  == Approx( calculateShiftFactor< Neutron >( 4, 2.00, 0. ) ) );
  CHECK( -3.1228727369542217  == Approx( calculateShiftFactor< Neutron >( 4, 2.25, 0. ) ) );
  CHECK( -2.8768199376623715  == Approx( calculateShiftFactor< Neutron >( 4, 2.50, 0. ) ) );
  CHECK( -2.6037247760912927  == Approx( calculateShiftFactor< Neutron >( 4, 2.75, 0. ) ) );
  CHECK( -2.3163485776017283  == Approx( calculateShiftFactor< Neutron >( 4, 3.00, 0. ) ) );
  CHECK( -2.0299850616477868  == Approx( calculateShiftFactor< Neutron >( 4, 3.25, 0. ) ) );
  CHECK( -1.7586712670710503  == Approx( calculateShiftFactor< Neutron >( 4, 3.50, 0. ) ) );
  CHECK( -1.5123756776128434  == Approx( calculateShiftFactor< Neutron >( 4, 3.75, 0. ) ) );
  CHECK( -1.2961343855235474  == Approx( calculateShiftFactor< Neutron >( 4, 4.00, 0. ) ) );
  CHECK( -1.1107905446564041  == Approx( calculateShiftFactor< Neutron >( 4, 4.25, 0. ) ) );
  CHECK( -0.95441527371871204 == Approx( calculateShiftFactor< Neutron >( 4, 4.50, 0. ) ) );
  CHECK( -0.82366800642532489 == Approx( calculateShiftFactor< Neutron >( 4, 4.75, 0. ) ) );
  CHECK( -0.71477297733440914 == Approx( calculateShiftFactor< Neutron >( 4, 5.00, 0. ) ) );
}
